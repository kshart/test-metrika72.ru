# Установка и запуск

### Wsl среда или Ubuntu
```sh
cp .env.example .env
docker run --rm \
    -v $(pwd):/opt \
    -w /opt \
    composer:latest \
    bash -c "composer install"
docker-compose build
docker-compose up
```

### Контейнер laravel.test
```sh
php artisan key:generate
php artisan migrate
```

### Запуск среды
```sh
docker-compose up
```

# Тестовое задание для metrika72.ru

Пользователь заполняет форму обращения к директору. Обращение сохраняется на бэкенде в базу, после чего отправляется на почту директору.

Поля для заполнения: почта, телефон, фамилия, имя, отчество, текст обращения, галочка “отправить анонимно”.

Если пользователь ставит галочку “отправить анонимно”, то поля: фамилия, имя, отчество, телефон, почта скрываются и в проверке валидации становятся не обязательными.

В случае, если пользователь уже отправлял обращение - выдать ошибку “Вами уже было отправлено обращение, ожидайте ответа”.

Самому решить как будет вычисляться уникальность пользователя.

## На фронтенде использовать NuxtJS 2.15 + Element UI:
 - требуется реализовать пустую страницу с кнопкой, при нажатии которой
открывается форма для заполнения;
 - форму выполнить отдельным компонентом;
 - т.к. форма может использоваться не только в модальном окне, но и просто как
отдельная страница, то требуется модальное окно выполнить отдельным
компонентом с вложенным компонентов формы;
 - после успешной отправки формы средствами Element UI отобразить;
сообщение пользователю;
 - обработать случай, если бэкенд возвращает ошибку;
 - реализовать как серверную, так и клиентскую валидация полей.

## Список полей формы:
 - почта: обязательное, является валидным значением email;
 - телефон: обязательное, значение соответствует моб.номеру;
 - имя: обязательное, длина максимум 15 символов;
 - фамилия: Обязательное, если не заполнено Отчество, длина максимум 20 символов;
 - Отчество: Обязательное, если не заполнена Фамилия;
 - Текст: Минимум 10 символов, максимум 200;
 - Отправить анонимно: boolean.

## На Бэкенде использовать Laravel 5.5:
1) Написать миграцию для создания необходимых таблиц;
2) Обработка событий допускается синхронная, но вне класса модели. Использовать механизмы подписки laravel;
3) Контроллер должен быть максимально лаконичным;
4) При сохранении формы должна фиксироваться дата создания;
5) После сохранения модели, на почту должно отправиться письмо со всеми полями формы + дата создания;
6) Шаблон письма должен быть отдельным файлов, как и логика формирования данных для него. Использовать штатные подходы laravel.

## База данных:
1) При выборе типа поля учесть особенности валидации;
2) Создать уникальный индекс, позволяющий не дублировать обращения от
одного пользователя;
3) Допустимо использование MySql/PostgreSQL;
4) Ответить на вопрос: Если в дальнейшем будет совершаться поиск в базе по
значению поля “отправлено анонимно”, нужен ли индекс?
